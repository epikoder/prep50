"use strict";function ownKeys(e,t){var n,l=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),l.push.apply(l,n)),l}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}window.mathquill4quill=function(t){var j=(t=t||{}).Quill||window.Quill,A=t.MathQuill||window.MathQuill,C=t.katex||window.katex,_=t.localStorage||window.localStorage;function x(t){try{return _.getItem(t)}catch(t){return""}}return function(n,t){function l(){return n.container.getElementsByClassName("ql-tooltip")[0]}function r(){return l().getElementsByTagName("input")[0]}var e,c,i,o,s,d,u,a,m,f,h,p,b,y,g,v,w,q,O;function E(n,t){var e=null==f.handlers?{}:f.handlers,l=(f.handlers=_objectSpread(_objectSpread({},e),{},{edit:function(){var t=l.latex(),e=(n.value=t,h);try{_.setItem(e,t)}catch(t){}},enter:function(){t.click()}}),A.getInterface(2).MathField(p,f)),e=x(h);return e&&l.latex(e),t.addEventListener("click",function(){var t=h;if((t=x(t))&&0<t.length){var e=i.indexOf(t);-1!=e&&i.splice(e,1),i.unshift(t),i.length>o&&i.pop();try{_.setItem(c,JSON.stringify(i))}catch(t){}}e=h;try{_.removeItem(e)}catch(t){}}),l}t=t||{},function(){if(j)if(A)if(C)if(n.options.modules.formula){if(MutationObserver)return 1;console.log("MutationObserver not defined")}else console.log("Formula module not enabled");else console.log("katex.js not loaded");else console.log("MathQuill.js not loaded");else console.log("Quill.js not loaded")}()&&(e=l(),c=t.historyCacheKey||"__mathquill4quill_historylist_cache__",i=function(t){try{return JSON.parse(_.getItem(t))||[]}catch(t){return[]}}(c),o=t.historySize||10,s=t.displayHistory||!1,d=t.displayDeleteButtonOnHistory||!1,m=null==t.autofocus||t.autofocus,f=null!=t.mathQuillConfig?t.mathQuillConfig:{},h=t.cacheKey||"__mathquill4quill_cache__",b=p=null,u={render:function(){var t,e,n;if(null==p)return t=r(),n=l().getElementsByClassName("ql-action")[0],(p=document.createElement("span")).setAttribute("class","mathquill4quill-mathquill-input"),b=t.className,t.setAttribute("class","mathquill4quill-latex-input"),a=E(t,n),e=a,m&&window.setTimeout(function(){return e.focus()},1),n=p,t.parentNode.insertBefore(n,t.nextSibling),a},destroy:function(){null!=p&&(r().setAttribute("class",b),p.remove(),p=null)}},g=t.operators||[],y={render:function(r){var t;null==v&&0!==g.length&&(t=l(),(v=document.createElement("div")).setAttribute("class","mathquill4quill-operator-container"),g.forEach(function(t){e=r,l=(t=t)[0],n=t[1],(t=document.createElement("button")).setAttribute("type","button"),t.setAttribute("data-value",n),C.render(l,t,{throwOnError:!1}),t.onclick=function(){/^\\[A-Za-z]+$/.test(n)?e.cmd(n):e.write(n),e.focus()};var e,n,l=t;l.setAttribute("class","mathquill4quill-operator-button"),v.appendChild(l)}),t.appendChild(v))},destroy:function(){null!=v&&(v.remove(),v=null)}},q=i||[],O=v=null,w={render:function(u){var t,a,e;(t=l()).getBoundingClientRect().top-n.container.getBoundingClientRect().top<0&&(t.style.top="0px"),null==O&&s&&0!==q.length&&(t=l(),O=document.createElement("div"),a=document.createElement("div"),e="mathquill4quill-history-container",d&&(e+=" mathquill4quill-history-container-with-delete-button"),a.setAttribute("class",e),(e=document.createElement("p")).innerHTML="Past formulas (max "+o+")",O.appendChild(e),q.forEach(function(n){t=n,e=u,(o=document.createElement("button")).setAttribute("type","button"),C.render(t,o,{throwOnError:!1}),o.onclick=function(){e.write(t),e.focus()};var t,e,l,r,i,o;o.setAttribute("class","mathquill4quill-history-button"),d?((l=document.createElement("div")).setAttribute("class","mathquill4quill-history-inner-container"),r=document.createElement("div"),(i=r).setAttribute("class","mathquill4quill-history-delete-button"),i.setAttribute("title","Delete"),i.setAttribute("role","button"),r.addEventListener("click",function(){l.remove();var t=q.indexOf(n),e=q;e.splice(t,1);try{_.setItem(c,JSON.stringify(e))}catch(t){}}),l.appendChild(o),l.appendChild(r),a.appendChild(l)):a.appendChild(o)}),O.appendChild(a),t.appendChild(O))},destroy:function(){null!=O&&(O.remove(),O=null)}},new MutationObserver(function(){var t;!e.classList.contains("ql-hidden")&&e.attributes["data-mode"]&&"formula"===e.attributes["data-mode"].value?(t=u.render(),y.render(t),w.render(t)):(u.destroy(),y.destroy(),w.destroy())}).observe(e,{attributes:!0,attributeFilter:["class","data-mode"]}))}},"undefined"!=typeof module&&module.exports&&(module.exports=window.mathquill4quill),window.Quill&&(window.Quill.prototype.enableMathQuillFormulaAuthoring=function(t){window.mathquill4quill()(this,t)});
